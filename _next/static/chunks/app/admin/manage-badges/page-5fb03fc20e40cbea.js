(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{3695:(e,a,t)=>{Promise.resolve().then(t.bind(t,7867))},7867:(e,a,t)=>{"use strict";t.d(a,{default:()=>eu});var l=t(5155),s=t(2115),r=t(9670),n=t(7481),i=t(285),d=t(2523),o=t(83),c=t(9556),m=t(7381),p=t(518),u=t(9434);let h=o.bL;o.YJ;let x=o.WT,g=s.forwardRef((e,a)=>{let{className:t,children:s,...r}=e;return(0,l.jsxs)(o.l9,{ref:a,className:(0,u.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[s,(0,l.jsx)(o.In,{asChild:!0,children:(0,l.jsx)(c.A,{className:"h-4 w-4 opacity-50"})})]})});g.displayName=o.l9.displayName;let f=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(o.PP,{ref:a,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,l.jsx)(m.A,{className:"h-4 w-4"})})});f.displayName=o.PP.displayName;let v=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(o.wn,{ref:a,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,l.jsx)(c.A,{className:"h-4 w-4"})})});v.displayName=o.wn.displayName;let j=s.forwardRef((e,a)=>{let{className:t,children:s,position:r="popper",...n}=e;return(0,l.jsx)(o.ZL,{children:(0,l.jsxs)(o.UC,{ref:a,className:(0,u.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,l.jsx)(f,{}),(0,l.jsx)(o.LM,{className:(0,u.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,l.jsx)(v,{})]})})});j.displayName=o.UC.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(o.JU,{ref:a,className:(0,u.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})}).displayName=o.JU.displayName;let b=s.forwardRef((e,a)=>{let{className:t,children:s,...r}=e;return(0,l.jsxs)(o.q7,{ref:a,className:(0,u.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(o.VF,{children:(0,l.jsx)(p.A,{className:"h-4 w-4"})})}),(0,l.jsx)(o.p4,{children:s})]})});b.displayName=o.q7.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(o.wv,{ref:a,className:(0,u.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=o.wv.displayName;var N=t(6695),y=t(2543),I=t(8718),w=t(6923),L=t(286),A=t(4301),D=t(8763),C=t(7223),U=t(6570),G=t(203),S=t(3926),k=t(5057),E=t(5452),B=t(5318);let z=E.bL;E.l9;let R=E.ZL;E.bm;let J=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(E.hJ,{ref:a,className:(0,u.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});J.displayName=E.hJ.displayName;let H=s.forwardRef((e,a)=>{let{className:t,children:s,...r}=e;return(0,l.jsxs)(R,{children:[(0,l.jsx)(J,{}),(0,l.jsxs)(E.UC,{ref:a,className:(0,u.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,(0,l.jsxs)(E.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(B.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});H.displayName=E.UC.displayName;let P=e=>{let{className:a,...t}=e;return(0,l.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};P.displayName="DialogHeader";let F=e=>{let{className:a,...t}=e;return(0,l.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};F.displayName="DialogFooter";let T=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(E.hE,{ref:a,className:(0,u.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});T.displayName=E.hE.displayName;let $=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(E.VY,{ref:a,className:(0,u.cn)("text-sm text-muted-foreground",t),...s})});$.displayName=E.VY.displayName;var O=t(2177),_=t(221),q=t(5594);let V=q.z.object({id:q.z.string().min(1,"ID is required").regex(/^[a-z0-9_]+$/,"ID can only contain lowercase letters, numbers, and underscores."),name:q.z.string().min(1,"Name is required"),portraitUrl:q.z.string().url("Must be a valid URL for portrait image"),personalGoalLevel:q.z.coerce.number().min(0,"Personal Goal Level must be 0 or greater").max(500,"Personal Goal Level cannot exceed 500")}),Z=e=>{let{isOpen:a,onClose:t,onSubmit:r,hero:o,allHeroes:c}=e,{toast:m}=(0,n.dj)(),{control:p,handleSubmit:u,reset:h,formState:{errors:x},setValue:g}=(0,O.mN)({resolver:(0,_.u)(V),defaultValues:{id:"",name:"",portraitUrl:"",personalGoalLevel:0}});return(0,s.useEffect)(()=>{o?(g("id",o.id),g("name",o.name),g("portraitUrl",o.portraitUrl),g("personalGoalLevel",o.personalGoalLevel)):h({id:"",name:"",portraitUrl:"",personalGoalLevel:0})},[o,a,h,g]),(0,l.jsx)(z,{open:a,onOpenChange:e=>!e&&t(),children:(0,l.jsxs)(H,{className:"sm:max-w-[425px]",children:[(0,l.jsxs)(P,{children:[(0,l.jsx)(T,{children:o?"Edit Hero":"Add New Hero"}),(0,l.jsxs)($,{children:[o?"Editing ".concat(o.name,". "):"Enter the details for the new hero. ","Hero ID must be unique. Personal Goal Level: 0 for no goal, max 500."]})]}),(0,l.jsxs)("form",{onSubmit:u(e=>{if(!o&&c.some(a=>a.id===e.id)){m({title:"Error: Duplicate ID",description:'A hero with ID "'.concat(e.id,'" already exists. Please use a unique ID.'),variant:"destructive"});return}let a=o?o.challenges:[];r({...e,challenges:a})}),className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"id",className:"text-right",children:"ID"}),(0,l.jsx)(O.xI,{name:"id",control:p,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"id",...a,className:"col-span-3",disabled:!!o})}}),x.id&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:x.id.message})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"name",className:"text-right",children:"Name"}),(0,l.jsx)(O.xI,{name:"name",control:p,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"name",...a,className:"col-span-3"})}}),x.name&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:x.name.message})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"portraitUrl",className:"text-right",children:"Portrait URL"}),(0,l.jsx)(O.xI,{name:"portraitUrl",control:p,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"portraitUrl",...a,className:"col-span-3"})}}),x.portraitUrl&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:x.portraitUrl.message})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"personalGoalLevel",className:"text-right",children:"Goal Level"}),(0,l.jsx)(O.xI,{name:"personalGoalLevel",control:p,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"personalGoalLevel",type:"number",...a,className:"col-span-3"})}}),x.personalGoalLevel&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:x.personalGoalLevel.message})]}),(0,l.jsxs)(F,{children:[(0,l.jsx)(i.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,l.jsx)(i.$,{type:"submit",children:o?"Save Changes":"Add Hero"})]})]})]})})};var M=t(6076);let Y=q.z.object({id:q.z.string().min(1,"Instance ID is required").regex(/^[a-z0-9_]+$/,"Instance ID can only contain lowercase letters, numbers, and underscores."),badgeId:q.z.string().min(1,"Badge Type is required"),level:q.z.coerce.number().min(1,"Initial Level must be 1 or greater").default(1)}),W=e=>{let{isOpen:a,onClose:t,onSubmit:r,badge:o,heroName:c,existingBadgeInstanceIds:m}=e,{toast:p}=(0,n.dj)(),{control:u,handleSubmit:f,reset:v,formState:{errors:N},setValue:y,watch:I}=(0,O.mN)({resolver:(0,_.u)(Y),defaultValues:{id:"",badgeId:Object.keys(M.E)[0]||"",level:1}}),w=I("badgeId"),L=(0,M.J)(w),A=L?L.icon:null;return(0,s.useEffect)(()=>{o?(y("id",o.id),y("badgeId",o.badgeId),y("level",o.level)):v({id:"badge_instance_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,7)),badgeId:Object.keys(M.E)[0]||"",level:1})},[o,a,v,y]),(0,l.jsx)(z,{open:a,onOpenChange:e=>!e&&t(),children:(0,l.jsxs)(H,{className:"sm:max-w-[480px]",children:[(0,l.jsxs)(P,{children:[(0,l.jsx)(T,{children:o?"Edit Badge Instance":"Add New Badge to ".concat(c)}),(0,l.jsxs)($,{children:[o?"Editing badge instance.":"Select a badge type and set its initial level for ".concat(c,"."),"Instance ID must be unique for this hero. Initial Level set here is the starting point."]})]}),(0,l.jsxs)("form",{onSubmit:f(e=>{if(!o&&m.includes(e.id)){p({title:"Error: Duplicate Badge Instance ID",description:'A badge instance with ID "'.concat(e.id,'" already exists for this hero. Please use a unique ID.'),variant:"destructive"});return}if(!(0,M.J)(e.badgeId)){p({title:"Error: Invalid Badge Type",description:'The selected badge type "'.concat(e.badgeId,'" is not valid.'),variant:"destructive"});return}r({id:e.id,badgeId:e.badgeId,level:e.level})}),className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"badge-instance-id",className:"text-right",children:"Instance ID"}),(0,l.jsx)(O.xI,{name:"id",control:u,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"badge-instance-id",...a,className:"col-span-3",disabled:!!o})}}),N.id&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:N.id.message})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"badge-type-id",className:"text-right",children:"Badge Type"}),(0,l.jsx)(O.xI,{name:"badgeId",control:u,render:e=>{let{field:a}=e;return(0,l.jsxs)(h,{onValueChange:a.onChange,value:a.value||"",disabled:!!o,children:[(0,l.jsx)(g,{className:"col-span-2",children:(0,l.jsx)(x,{placeholder:"Select a badge type"})}),(0,l.jsx)(j,{children:Object.values(M.E).map(e=>(0,l.jsxs)(b,{value:e.id,children:[e.title," (",e.id,")"]},e.id))})]})}}),A&&(0,l.jsx)(A,{className:"h-6 w-6 text-primary"}),N.badgeId&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:N.badgeId.message})]}),L&&(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{className:"text-right col-span-1",children:"Details"}),(0,l.jsxs)("div",{className:"col-span-3 text-sm text-muted-foreground",children:[(0,l.jsxs)("p",{children:["Title: ",L.title]}),(0,l.jsxs)("p",{children:["XP/Level: ",L.xpPerLevel]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(k.J,{htmlFor:"badge-level",className:"text-right",children:"Initial Level"}),(0,l.jsx)(O.xI,{name:"level",control:u,render:e=>{let{field:a}=e;return(0,l.jsx)(d.p,{id:"badge-level",type:"number",...a,className:"col-span-3",placeholder:"Default is 1"})}}),N.level&&(0,l.jsx)("p",{className:"col-span-4 text-destructive text-sm text-right",children:N.level.message})]}),(0,l.jsxs)(F,{children:[(0,l.jsx)(i.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,l.jsx)(i.$,{type:"submit",children:o?"Save Changes":"Add Badge Instance"})]})]})]})})};var X=t(7649);let K=X.bL,Q=X.l9,ee=X.ZL,ea=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(X.hJ,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a})});ea.displayName=X.hJ.displayName;let et=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsxs)(ee,{children:[(0,l.jsx)(ea,{}),(0,l.jsx)(X.UC,{ref:a,className:(0,u.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]})});et.displayName=X.UC.displayName;let el=e=>{let{className:a,...t}=e;return(0,l.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};el.displayName="AlertDialogHeader";let es=e=>{let{className:a,...t}=e;return(0,l.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};es.displayName="AlertDialogFooter";let er=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(X.hE,{ref:a,className:(0,u.cn)("text-lg font-semibold",t),...s})});er.displayName=X.hE.displayName;let en=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(X.VY,{ref:a,className:(0,u.cn)("text-sm text-muted-foreground",t),...s})});en.displayName=X.VY.displayName;let ei=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(X.rc,{ref:a,className:(0,u.cn)((0,i.r)(),t),...s})});ei.displayName=X.rc.displayName;let ed=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,l.jsx)(X.ZD,{ref:a,className:(0,u.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...s})});ed.displayName=X.ZD.displayName;var eo=t(6874),ec=t.n(eo);let em="overwatchProgressionData_v3",ep="1.0.0";function eu(){let[e,a]=(0,s.useState)([]),[t,o]=(0,s.useState)(null),[c,m]=(0,s.useState)(!1),[p,u]=(0,s.useState)(null),[f,v]=(0,s.useState)(!1),[k,E]=(0,s.useState)(null),{toast:B}=(0,n.dj)(),z=(0,s.useCallback)(()=>{let e=localStorage.getItem(em);if(e)try{let t,l;try{t=JSON.parse(e)}catch(e){console.error("Failed to parse localStorage, resetting to default:",e),t={version:"0.0.0",heroes:r.tN}}"object"==typeof t&&null!==t&&"version"in t&&"heroes"in t&&Array.isArray(t.heroes)?l=t.heroes:Array.isArray(t)?l=t:(console.warn("Invalid data format in localStorage, using initial defaults."),l=r.tN);let s=l.map(e=>{var a;return{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(e=>{var a;return{id:e.id,badgeId:e.badgeId,level:null!==(a=e.level)&&void 0!==a?a:1}})}});a(s)}catch(e){console.error("Failed to parse hero data from localStorage",e),a(r.tN.map(e=>{var a;return{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(e=>{var a;return{id:e.id,badgeId:e.badgeId,level:null!==(a=e.level)&&void 0!==a?a:1}})}}))}else a(r.tN.map(e=>{var a;return{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(e=>{var a;return{id:e.id,badgeId:e.badgeId,level:null!==(a=e.level)&&void 0!==a?a:1}})}}))},[]);(0,s.useEffect)(()=>{z()},[z]);let R=(0,s.useCallback)(e=>{let l=e.map(e=>{var a;return{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel&&e.personalGoalLevel>=0?e.personalGoalLevel:0,challenges:e.challenges.map(e=>({id:e.id,badgeId:e.badgeId,level:e.level}))}});a(l),localStorage.setItem(em,JSON.stringify({version:ep,heroes:l})),t&&!l.find(e=>e.id===t)&&o(null)},[t]),J=e=>{u(e),m(!0)},H=a=>{R(e.filter(e=>e.id!==a)),t===a&&o(null),B({title:"Hero Deleted",description:"The hero has been removed."})},P=e=>{E(e),v(!0)},F=a=>{t&&(R(e.map(e=>e.id===t?{...e,challenges:e.challenges.filter(e=>e.id!==a)}:e)),B({title:"Badge Instance Deleted",description:"The badge instance has been removed from the hero."}))},T=(a,l)=>{t&&R(e.map(e=>{if(e.id===t){let t=[...e.challenges],s=t.findIndex(e=>e.id===a);if(-1===s)return e;let r=-1;if("up"===l&&s>0)r=s-1,[t[s],t[s-1]]=[t[s-1],t[s]];else{if("down"!==l||!(s<t.length-1))return e;r=s+1,[t[s],t[s+1]]=[t[s+1],t[s]]}let n=(0,M.J)(t[r].badgeId);return B({title:"Badge Reordered",description:'Badge "'.concat((null==n?void 0:n.title)||t[r].badgeId,'" has been moved.')}),{...e,challenges:t}}return e}))},$=e.find(e=>e.id===t);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(i.$,{variant:"outline",asChild:!0,children:(0,l.jsxs)(ec(),{href:"/",children:[(0,l.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Back to Tracker"]})}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(i.$,{onClick:()=>{let a=new Blob([JSON.stringify({version:ep,heroes:e},null,2)],{type:"application/json"}),t=URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download="overwatch_progression_data.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),B({title:"Data Exported",description:"Your hero progression data has been downloaded."})},variant:"outline",children:[(0,l.jsx)(I.A,{className:"mr-2 h-4 w-4"})," Export Data"]}),(0,l.jsx)(i.$,{variant:"outline",asChild:!0,children:(0,l.jsxs)("label",{htmlFor:"import-file-input",className:"cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",children:[(0,l.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Import Data",(0,l.jsx)(d.p,{id:"import-file-input",type:"file",accept:".json",className:"hidden",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!t){B({title:"Import Cancelled",description:"No file selected.",variant:"default"});return}let l=new FileReader;l.onload=a=>{try{var t;let e;let l=null===(t=a.target)||void 0===t?void 0:t.result,s=JSON.parse(l);if("object"==typeof s&&null!==s&&"version"in s&&"heroes"in s&&Array.isArray(s.heroes))s.version!==ep&&B({title:"Import Warning",description:"Data is from a different version (imported: ".concat(s.version,", current: ").concat(ep,"). Proceeding with import."),variant:"default"}),e=s.heroes;else if(Array.isArray(s))e=s,B({title:"Import Warning",description:"Imported data is in a legacy format. Proceeding with import.",variant:"default"});else{B({title:"Import Error",description:"Invalid file format.",variant:"destructive"});return}if(!Array.isArray(e)||!e.every(e=>e.id&&e.name&&Array.isArray(e.challenges)&&e.challenges.every(e=>e.id&&e.badgeId&&"number"==typeof e.level))){B({title:"Import Error",description:"Imported data is not in the expected StoredHero[] format or has missing fields.",variant:"destructive"});return}let r=e.map(e=>{var a;return{id:e.id,name:e.name,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(a=>{var t;return(0,M.J)(a.badgeId)?{id:a.id,badgeId:a.badgeId,level:Math.max(1,null!==(t=a.level)&&void 0!==t?t:1)}:(console.warn('Import: Badge definition not found for badgeId "'.concat(a.badgeId,'" on hero "').concat(e.name,'". Skipping this badge instance.')),null)}).filter(Boolean)}});R(r),o(null),B({title:"Data Imported",description:"Hero progression data has been successfully imported."})}catch(e){console.error("Error importing data:",e),B({title:"Import Error",description:"Failed to parse or process the JSON file. Make sure it's a valid export.",variant:"destructive"})}finally{e.target&&(e.target.value="")}},l.onerror=()=>{B({title:"Import Error",description:"Failed to read the file.",variant:"destructive"}),e.target&&(e.target.value="")},l.readAsText(t)}})]})})]})]}),(0,l.jsxs)(N.Zp,{children:[(0,l.jsxs)(N.aR,{children:[(0,l.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(L.A,{})," Heroes"]}),(0,l.jsx)(N.BT,{children:"Select a hero to manage their badges or add a new hero."})]}),(0,l.jsx)(N.Wu,{className:"space-y-4",children:(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,l.jsxs)(h,{onValueChange:e=>{o(e),E(null)},value:t||void 0,children:[(0,l.jsx)(g,{className:"w-[250px]",children:(0,l.jsx)(x,{placeholder:"Select a hero"})}),(0,l.jsx)(j,{children:e.map(e=>(0,l.jsx)(b,{value:e.id,children:e.name},e.id))})]}),(0,l.jsxs)(i.$,{onClick:()=>{u(null),m(!0)},variant:"outline",children:[(0,l.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Add Hero"]}),$&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.$,{onClick:()=>J($),variant:"outline",size:"icon","aria-label":"Edit Hero",children:[(0,l.jsx)(D.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Edit Hero"})]}),(0,l.jsxs)(K,{children:[(0,l.jsx)(Q,{asChild:!0,children:(0,l.jsxs)(i.$,{variant:"destructive",size:"icon","aria-label":"Delete Hero",children:[(0,l.jsx)(C.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Delete Hero"})]})}),(0,l.jsxs)(et,{children:[(0,l.jsxs)(el,{children:[(0,l.jsx)(er,{children:"Are you sure?"}),(0,l.jsxs)(en,{children:['This will permanently delete the hero "',$.name,'" and all their badge data. This action cannot be undone.']})]}),(0,l.jsxs)(es,{children:[(0,l.jsx)(ed,{children:"Cancel"}),(0,l.jsx)(ei,{onClick:()=>H($.id),children:"Delete Hero"})]})]})]})]})]})})]}),$&&(0,l.jsxs)(N.Zp,{children:[(0,l.jsxs)(N.aR,{children:[(0,l.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(U.A,{})," Badges for ",$.name]}),(0,l.jsx)(N.BT,{children:"Manage the badge instances for this hero. You can reorder badges using the arrow buttons."})]}),(0,l.jsxs)(N.Wu,{className:"space-y-4",children:[(0,l.jsxs)(i.$,{onClick:()=>{t&&(E(null),v(!0))},variant:"outline",children:[(0,l.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Add Badge Instance to ",$.name]}),$.challenges.length>0?(0,l.jsx)("ul",{className:"space-y-2",children:$.challenges.map((e,a)=>{let t=(0,M.J)(e.badgeId);return(0,l.jsxs)("li",{className:"flex items-center justify-between p-3 bg-card-foreground/5 rounded-md",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>T(e.id,"up"),disabled:0===a,"aria-label":"Move badge up",className:"h-6 w-6",children:(0,l.jsx)(G.A,{className:"h-4 w-4"})}),(0,l.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>T(e.id,"down"),disabled:a===$.challenges.length-1,"aria-label":"Move badge down",className:"h-6 w-6",children:(0,l.jsx)(S.A,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:[(null==t?void 0:t.title)||"Unknown Badge"," ",(0,l.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(Instance ID: ",e.id,")"]})]}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Type ID: ",e.badgeId,", XP/Lvl: ",(null==t?void 0:t.xpPerLevel)||"N/A",", Initial Lvl: ",e.level]})]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(i.$,{onClick:()=>P(e),variant:"outline",size:"icon","aria-label":"Edit Badge Instance",children:[(0,l.jsx)(D.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Edit Badge Instance"})]}),(0,l.jsxs)(K,{children:[(0,l.jsx)(Q,{asChild:!0,children:(0,l.jsxs)(i.$,{variant:"destructive",size:"icon","aria-label":"Delete Badge Instance",children:[(0,l.jsx)(C.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Delete Badge Instance"})]})}),(0,l.jsxs)(et,{children:[(0,l.jsxs)(el,{children:[(0,l.jsx)(er,{children:"Are you sure?"}),(0,l.jsxs)(en,{children:['This will permanently delete the badge instance "',(null==t?void 0:t.title)||e.id,'" from ',$.name,". This action cannot be undone."]})]}),(0,l.jsxs)(es,{children:[(0,l.jsx)(ed,{children:"Cancel"}),(0,l.jsx)(ei,{onClick:()=>F(e.id),children:"Delete Badge Instance"})]})]})]})]})]},e.id)})}):(0,l.jsxs)("p",{className:"text-muted-foreground",children:["No badge instances configured for ",$.name,"."]})]})]}),(0,l.jsx)(Z,{isOpen:c,onClose:()=>{m(!1),u(null)},onSubmit:a=>{var l;let s;let r={...a,portraitUrl:(null===(l=a.portraitUrl)||void 0===l?void 0:l.trimStart())||"",personalGoalLevel:"number"==typeof a.personalGoalLevel?a.personalGoalLevel:0,challenges:a.challenges.map(e=>({id:e.id,badgeId:e.badgeId,level:e.level}))};if(p)s=e.map(e=>{var a;return e.id===r.id?r:{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(e=>({id:e.id,badgeId:e.badgeId,level:e.level}))}}),B({title:"Hero Updated",description:"".concat(r.name," has been updated.")});else{if(e.some(e=>e.id===r.id)){B({title:"Error",description:'Hero ID "'.concat(r.id,'" already exists. Please use a unique ID.'),variant:"destructive"});return}s=[...e.map(e=>{var a;return{...e,portraitUrl:(null===(a=e.portraitUrl)||void 0===a?void 0:a.trimStart())||"",personalGoalLevel:"number"==typeof e.personalGoalLevel?e.personalGoalLevel:0,challenges:e.challenges.map(e=>({id:e.id,badgeId:e.badgeId,level:e.level}))}}),r],B({title:"Hero Added",description:"".concat(r.name," has been added.")})}R(s),m(!1),u(null),(!p||p&&t!==r.id)&&o(r.id)},hero:p,allHeroes:e}),(0,l.jsx)(W,{isOpen:f,onClose:()=>{v(!1),E(null)},onSubmit:a=>{t&&(R(e.map(e=>{if(e.id===t){let t;if(k)t=e.challenges.map(e=>e.id===a.id?a:e),B({title:"Badge Instance Updated",description:'Badge instance "'.concat(a.id,'" has been updated.')});else{if(e.challenges.some(e=>e.id===a.id)){B({title:"Error",description:'Badge instance ID "'.concat(a.id,'" already exists for this hero. Please use a unique ID.'),variant:"destructive"});return}t=[...e.challenges,a];let l=(0,M.J)(a.badgeId);B({title:"Badge Instance Added",description:'Badge "'.concat((null==l?void 0:l.title)||a.badgeId,'" has been added to ').concat(e.name,".")})}return{...e,challenges:t}}return e})),v(!1),E(null))},badge:k,heroName:(null==$?void 0:$.name)||"",existingBadgeInstanceIds:(null==$?void 0:$.challenges.map(e=>e.id))||[]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[774,378,928,122,441,684,358],()=>a(3695)),_N_E=e.O()}]);